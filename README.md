<img width="1414" height="2000" alt="phginfogr" src="https://github.com/user-attachments/assets/cc5860d4-2a8b-45b1-92c4-8816b83a84fb" />

# ğŸ“˜ DicionÃ¡rio de Dados â€“ UF

O **DicionÃ¡rio de Dados por Unidade da FederaÃ§Ã£o (UF)** Ã© um documento oficial que define e padroniza os principais indicadores de criminalidade registrados no Brasil, dentro do sistema **Sinesp IntegraÃ§Ã£o**.  

Ele serve como **base conceitual e metodolÃ³gica**, garantindo consistÃªncia e comparabilidade entre os dados fornecidos pelos diferentes estados.

---

## ğŸ” ConteÃºdo do DicionÃ¡rio

### 1. Indicadores e DefiniÃ§Ãµes
Cada tipo de crime Ã© descrito de forma detalhada, especificando:
- O que caracteriza a ocorrÃªncia (ex.: homicÃ­dio doloso, estupro, roubo de carga etc.).
- CritÃ©rios legais e tÃ©cnicos para classificaÃ§Ã£o.
- ObservaÃ§Ãµes sobre exceÃ§Ãµes e enquadramentos especÃ­ficos.

### 2. Unidades de Medida
As mÃ©tricas padronizadas utilizadas incluem:
- **OcorrÃªncias** â†’ nÃºmero de registros de crimes.  
- **VÃ­timas** â†’ nÃºmero de pessoas registradas como vÃ­timas.  
- **PopulaÃ§Ã£o** â†’ estimativa oficial do IBGE (2018).  
- **Taxa/100.000** â†’ taxa padronizada de crimes por 100 mil habitantes, permitindo comparaÃ§Ãµes entre estados.

### 3. Notas e ObservaÃ§Ãµes
O dicionÃ¡rio explica limitaÃ§Ãµes e cuidados para interpretar os dados:
- PadronizaÃ§Ã£o oficial passou a vigorar apÃ³s 2018.  
- DiferenÃ§as podem ocorrer devido a mÃ©todos de coleta e consolidaÃ§Ã£o estaduais.  
- HÃ¡ defasagens de atualizaÃ§Ã£o em alguns perÃ­odos.

### 4. Escopo Temporal e GeogrÃ¡fico
- Os dados sÃ£o apresentados por **mÃªs/ano**, abrangendo registros de **2015 em diante**.  
- A unidade geogrÃ¡fica de anÃ¡lise Ã© a **Unidade da FederaÃ§Ã£o (estado)**.

### 5. Fonte
- Dados extraÃ­dos diretamente das soluÃ§Ãµes **SinespJC** e **Sinesp IntegraÃ§Ã£o**.  
- Exemplo de extraÃ§Ã£o presente no documento: **14/03/2019**.

---

## âœ… ImportÃ¢ncia
Esse dicionÃ¡rio garante que os dados analisados sejam **claros, comparÃ¡veis e confiÃ¡veis**, evitando interpretaÃ§Ãµes incorretas sobre os registros de criminalidade ao longo dos estados brasileiros.

# ğŸ“˜ DicionÃ¡rio de Dados â€“ MunicÃ­pios

O **DicionÃ¡rio de Dados por MunicÃ­pio** complementa o dicionÃ¡rio por Unidade da FederaÃ§Ã£o (UF), mas com foco em uma granularidade **local**. Ele estabelece as definiÃ§Ãµes, mÃ©tricas e metodologias para anÃ¡lise dos crimes registrados em nÃ­vel municipal.

---

## ğŸ” ConteÃºdo do DicionÃ¡rio

### 1. Indicadores e DefiniÃ§Ãµes
- Foco em crimes como **homicÃ­dio doloso** e outros tipos de violÃªncia.  
- SÃ£o utilizados os mesmos critÃ©rios legais e tÃ©cnicos do dicionÃ¡rio por UF, garantindo consistÃªncia.  
- Especifica exceÃ§Ãµes (ex.: exclusÃ£o de feminicÃ­dio do indicador de homicÃ­dio doloso) e detalha a forma de classificaÃ§Ã£o segundo o **CÃ³digo Penal**.

### 2. Unidades de Medida
- **VÃ­timas** â†’ nÃºmero de pessoas registradas como vÃ­timas em boletins de ocorrÃªncia.  
- Essa Ã© a principal mÃ©trica utilizada para mensurar o impacto da violÃªncia em nÃ­vel municipal.

### 3. Metodologia
- Os dados sÃ£o fornecidos pelas **Secretarias Estaduais de EstatÃ­stica e SeguranÃ§a PÃºblica**, por meio da **CoordenaÃ§Ã£o Geral de EstatÃ­stica (CGESt)**.  
- Processo envolve **coleta mensal**, **validaÃ§Ã£o** e **atualizaÃ§Ã£o periÃ³dica**.  
- Sistemas utilizados:  
  - **SinespJC**  
  - **Sinesp IntegraÃ§Ã£o**  
- ApÃ³s validaÃ§Ã£o, os dados sÃ£o encaminhados para atualizaÃ§Ã£o das bases nacionais e para alimentar o **painel pÃºblico de estatÃ­sticas de seguranÃ§a**.

### 4. Notas Importantes
- Registros anteriores a **dezembro/2018** podem nÃ£o seguir a padronizaÃ§Ã£o oficial da Portaria nÂº 229/2018.  
- DiferenÃ§as podem ocorrer entre totais por UF e MunicÃ­pios devido a ajustes de coleta, tratamento e consolidaÃ§Ã£o feitos pelos estados.  
- Exemplo: em 2019, o estado do AmapÃ¡ apresentou cobertura maior apÃ³s avanÃ§os na implantaÃ§Ã£o do sistema.

### 5. Unidade GeogrÃ¡fica e Periodicidade
- **Unidade GeogrÃ¡fica de AnÃ¡lise:** MunicÃ­pio.  
- **Periodicidade:**  
  - Coleta mensal.  
  - PublicaÃ§Ã£o atÃ© o dia 15 de cada mÃªs.  
  - AtualizaÃ§Ã£o com dados de atÃ© 3 meses anteriores ao mÃªs da coleta.

### 6. Fonte
- Dados validados e disponibilizados pelos **Gestores Estaduais de EstatÃ­stica**.  
- ExtraÃ­dos dos sistemas **SinespJC** e **Sinesp IntegraÃ§Ã£o**.

---

## âœ… ImportÃ¢ncia
Esse dicionÃ¡rio Ã© essencial para anÃ¡lises **granulares e comparativas entre municÃ­pios**, permitindo observar padrÃµes locais de criminalidade, identificar Ã¡reas crÃ­ticas e orientar polÃ­ticas pÃºblicas de seguranÃ§a com maior precisÃ£o.

# ğŸ“Š Arquivos XLSX Brutos

AlÃ©m dos dicionÃ¡rios de dados (UF e MunicÃ­pios), o projeto utiliza como **fonte primÃ¡ria** os arquivos **XLSX brutos** disponibilizados pelo **Sinesp (Sistema Nacional de SeguranÃ§a PÃºblica)**. Esses arquivos sÃ£o a base para todas as transformaÃ§Ãµes realizadas nas camadas **Bronze â†’ Silver â†’ Gold** do pipeline de dados.

---

## ğŸ—‚ï¸ Estrutura dos Arquivos

Os arquivos seguem um padrÃ£o dividido em **abas (sheets)** por **Unidade da FederaÃ§Ã£o (UF)**, cada uma contendo registros de crimes e vÃ­timas. Entre os principais campos presentes:

- **Cod_IBGE** â†’ CÃ³digo Ãºnico de identificaÃ§Ã£o do municÃ­pio.  
- **MunicÃ­pio** â†’ Nome oficial do municÃ­pio.  
- **Sigla UF** â†’ AbreviaÃ§Ã£o da Unidade Federativa (ex.: AC, SP, RS).  
- **RegiÃ£o** â†’ MacrorregiÃ£o correspondente (Norte, Nordeste, Sudeste, Sul, Centro-Oeste).  
- **MÃªs/Ano** â†’ PerÃ­odo da ocorrÃªncia ou registro.  
- **Tipo de Crime** â†’ ClassificaÃ§Ã£o do crime (ex.: HomicÃ­dio Doloso, Estupro, Roubo de VeÃ­culo etc.).  
- **Sexo da VÃ­tima** â†’ Feminino, Masculino ou "Sexo NI" (nÃ£o informado).  
- **OcorrÃªncias** â†’ Quantidade de ocorrÃªncias registradas para aquele crime no perÃ­odo.  
- **VÃ­timas** â†’ NÃºmero de pessoas registradas como vÃ­timas.

---

## ğŸ”„ RelaÃ§Ã£o com os DicionÃ¡rios

Os dicionÃ¡rios de dados (UF e MunicÃ­pios) funcionam como **guia de interpretaÃ§Ã£o** dos XLSX, garantindo que:

- **Indicadores** (ex.: HomicÃ­dio Doloso, Estupro) sejam entendidos de forma padronizada.  
- **Unidades de medida** (VÃ­timas, OcorrÃªncias, Taxa/100000) sejam aplicadas corretamente.  
- **Metodologia** (coleta, atualizaÃ§Ã£o, publicaÃ§Ã£o) seja respeitada, assegurando a confiabilidade da anÃ¡lise.  

Assim, os arquivos brutos **nÃ£o devem ser interpretados isoladamente**: o dicionÃ¡rio garante consistÃªncia legal, tÃ©cnica e metodolÃ³gica.

---

## â±ï¸ Periodicidade e AtualizaÃ§Ã£o

- Os dados sÃ£o **mensais**, com cada linha representando um agregado por UF ou MunicÃ­pio.  
- As planilhas podem conter diferenÃ§as de cobertura dependendo do perÃ­odo e da evoluÃ§Ã£o do sistema Sinesp em cada estado.  
- AtualizaÃ§Ãµes seguem o fluxo descrito no dicionÃ¡rio:
  - **Coleta mensal**
  - **ValidaÃ§Ã£o** pelas Secretarias Estaduais
  - **PublicaÃ§Ã£o** no painel oficial atÃ© o dia 15 de cada mÃªs

---

## âœ… ImportÃ¢ncia para o Pipeline

Os **arquivos XLSX brutos** representam a **camada de entrada (Landing â†’ Bronze)** do pipeline.  
Ã‰ a partir deles que:
1. Os dados sÃ£o **ingeridos e normalizados**.  
2. Passam por limpeza e padronizaÃ§Ã£o (Silver).  
3. SÃ£o agregados, enriquecidos e preparados para anÃ¡lises avanÃ§adas e dashboards (Gold).

Sem essa base estruturada, nÃ£o seria possÃ­vel construir as anÃ¡lises regionais, comparativos e indicadores derivados que alimentam o projeto.


# ğŸ¥‰Camada Bronze (IngestÃ£o & PadronizaÃ§Ã£o)

A **Camada Bronze** do projeto SINESP Ã© responsÃ¡vel por **ingerir os arquivos brutos (XLSX)**, baixados do portal [dados.gov.br](https://dados.gov.br/dados/conjuntos-dados/sistema-nacional-de-estatisticas-de-seguranca-publica), e transformÃ¡-los em **tabelas Delta padronizadas**, prontas para uso nas prÃ³ximas camadas (**Silver** e **Gold**).

---

## ğŸ¯ Objetivos da Bronze
- **Automatizar a ingestÃ£o** dos arquivos publicados (UF e MunicÃ­pios).  
- **Versionar os binÃ¡rios** (hash SHA256 + data de aquisiÃ§Ã£o).  
- **Manter um manifesto** com metadados de cada arquivo baixado.  
- **Padronizar colunas e tipos** para simplificar o consumo posterior.  
- **Armazenar todos os registros sem perder informaÃ§Ã£o**, mesmo que inconsistentes, aplicando apenas â€œchecks levesâ€.

---

## ğŸ“‚ Estrutura dos DiretÃ³rios (Landing)
Os arquivos originais sÃ£o salvos em um **Volume Unity Catalog**:
- **sha256** â†’ assinatura Ãºnica para identificar o binÃ¡rio.
- **acquired_date** â†’ data em que o arquivo foi adquirido.
- **manifest.csv** â†’ log com informaÃ§Ãµes de URL, tamanho, hash, ETag, Last-Modified.

---
## ğŸ› ï¸ Principais Scripts

### 1. ğŸ“¥ Download & Landing
Arquivo: **data**  
- Descobre URLs via **API CKAN** do MinistÃ©rio da JustiÃ§a.  
- Faz download com **retry e backoff exponencial**.  
- Gera hash `sha256` para cada arquivo.  
- Cria diretÃ³rio no landing com `acquired_date` + `sha256`.  
- Registra o arquivo no **manifesto** para auditoria.

### 2. ğŸ™ï¸ IngestÃ£o de MunicÃ­pios
Arquivo: **Ingestao_dos_DadosMunicÃ­pio**  
- Localiza o XLSX mais recente no landing.  
- Abre as **27 abas** (uma por UF).  
- Normaliza colunas (`cod_ibge`, `municipio`, `uf`, `regiao`, `mes_ano`, `vitimas`).  
- Faz parsing de `mes_ano` â†’ `ano`, `mes`, `year_month`.  
- Aplica checks leves:
  - `vitimas >= 0`
  - `uf` consistente
- Cria tabelas por UF (`sinesp.bronze.DadosMunicipioAC`, etc).  
- Cria tabela unificada (`sinesp.bronze.municipios_raw_row`), particionada por `uf`, `ano`, `mes`.

### 3. ğŸ›ï¸ IngestÃ£o por UF
Arquivo: **Ingestao_dos_DadosUF**  
- Localiza XLSX mais recente da pasta **uf**.  
- Identifica abas: `OcorrÃªncias` e `VÃ­timas`.  
- Normaliza colunas (`uf_nome`, `uf_sigla`, `tipo_crime`, `ano`, `mes`, `ocorrencias`, `vitimas`, `sexo_vitima`).  
- Faz parsing de `MÃªs` (texto) â†’ nÃºmero (`janeiro â†’ 1`).  
- Aplica checks leves:
  - UF vÃ¡lida
  - Sem valores negativos
- Cria tabelas:
  - `sinesp.bronze.ufocorrencias`
  - `sinesp.bronze.ufvitimas`

---

## ğŸ§¹ PadronizaÃ§Ã£o Aplicada
- **Colunas em snake_case**.  
- **Datas parseadas** para `ano` (INT), `mes` (INT), `year_month` (DATE).  
- **Tipos numÃ©ricos coerentes** (`cod_ibge` = BIGINT, `vitimas/ocorrencias` = INT).  
- **Metadados preservados** (`_ingestion_ts`, `_source_path`) para rastreabilidade.  

---

## âœ… BenefÃ­cios da Bronze
- MantÃ©m os **dados integrais** do SINESP (mesmo inconsistentes).  
- Garante **reprodutibilidade** (manifesto + versionamento por hash).  
- Simplifica a transiÃ§Ã£o para Silver (onde serÃ£o aplicadas regras de qualidade mais rÃ­gidas).  
- Permite auditoria: qualquer dado analisado pode ser rastreado atÃ© o **arquivo bruto**.

---

# ğŸ¥ˆ Camada Silver â€“ Projeto Sinesp

A **camada Silver** Ã© responsÃ¡vel por transformar os dados brutos da Bronze em um formato **padronizado, confiÃ¡vel e pronto para anÃ¡lises**.  
Enquanto a Bronze preserva os dados praticamente crus, a Silver aplica **ajustes, validaÃ§Ãµes e padronizaÃ§Ãµes** que garantem consistÃªncia e eliminam ruÃ­dos.

---

## ğŸ”„ Objetivo da Silver
- Corrigir e validar campos como **ano, mÃªs e UF**.  
- Padronizar nomes de colunas e tipos de dados.  
- Tratar valores nulos ou inconsistentes.  
- Preparar os dados para anÃ¡lises na **camada Gold** e para dashboards em **Databricks SQL**.  

---

## ğŸ“‚ Estrutura dos Notebooks

Dentro da pasta `notebooks/silver_transformations/` existem trÃªs notebooks principais:

### 1. `transformaÃ§Ã£omunicipios.ipynb`
- **Fonte**: `sinesp.bronze.municipios_raw_row`  
- **TransformaÃ§Ãµes**:
  - DerivaÃ§Ã£o de `ano` e `mes` a partir de `mes_ano`.
  - PadronizaÃ§Ã£o de colunas (`cod_ibge`, `municipio`, `uf_sigla`, `regiao`, `vitimas`).
  - ValidaÃ§Ã£o de registros com ano/mÃªs vÃ¡lidos.
- **SaÃ­da**: `sinesp.silver.municipios_vitimas`

ğŸ‘‰ Permite anÃ¡lises detalhadas por **municÃ­pio**.

---

### 2. `transformaÃ§Ã£oocorrencias.ipynb`
- **Fonte**: `sinesp.bronze.ufocorrencias`  
- **TransformaÃ§Ãµes**:
  - PadronizaÃ§Ã£o de colunas (`uf_nome`, `uf_sigla`, `tipo_crime`, `ano`, `mes`, `ocorrencias`).
  - ConversÃ£o de colunas para tipos corretos.
  - Filtro de registros invÃ¡lidos.
- **SaÃ­da**: `sinesp.silver.uf_ocorrencias`

ğŸ‘‰ Permite acompanhar o volume de **ocorrÃªncias criminais por UF**.

---

### 3. `transformaÃ§Ã£ovitima.ipynb`
- **Fonte**: `sinesp.bronze.ufvitimas`  
- **TransformaÃ§Ãµes**:
  - PadronizaÃ§Ã£o de colunas (`uf_nome`, `uf_sigla`, `tipo_crime`, `sexo_vitima`, `ano`, `mes`, `vitimas`).
  - NormalizaÃ§Ã£o de valores de sexo (`Feminino`, `Masculino`, `Sexo NI`).
  - ConversÃ£o para tipos consistentes.
- **SaÃ­da**: `sinesp.silver.uf_vitimas`

ğŸ‘‰ Possibilita anÃ¡lises sobre o **perfil das vÃ­timas por UF e sexo**.

---

## ğŸ“Š Tabelas Resultantes

1. **`sinesp.silver.municipios_vitimas`**  
   - Campos principais: `cod_ibge`, `municipio`, `uf_sigla`, `regiao`, `ano`, `mes`, `vitimas`.

2. **`sinesp.silver.uf_ocorrencias`**  
   - Campos principais: `uf_sigla`, `uf_nome`, `tipo_crime`, `ano`, `mes`, `ocorrencias`.

3. **`sinesp.silver.uf_vitimas`**  
   - Campos principais: `uf_sigla`, `uf_nome`, `tipo_crime`, `sexo_vitima`, `ano`, `mes`, `vitimas`.

---

## âœ… BenefÃ­cios
- Dados **limpos e padronizados**.  
- **ConsistÃªncia** entre diferentes fontes (municÃ­pios e UFs).  
- Base pronta para **dashboards interativos** e relatÃ³rios.  
- Facilita a criaÃ§Ã£o de visÃµes consolidadas na **camada Gold**.  

---
